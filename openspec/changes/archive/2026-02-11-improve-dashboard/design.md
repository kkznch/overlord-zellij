## Context

6エージェントの Zellij セッションでは、個別のステータス確認にタブ切替が必要。リレーファイルストアにステータスとメッセージは既に永続化されているが、統合ビューがない。4つ目のタブとして TUI ダッシュボードを追加し、1画面で全体を俯瞰できるようにする。

## Goals / Non-Goals

**Goals:**
- 全6ロールのリアルタイム概観（ステータス・タスク・経過時間）
- ペンディングメッセージインジケータと最新メッセージフィード
- Zellij レイアウトへの4つ目タブとしての自動統合
- リレーストアへの読み取り専用アクセス（メッセージ状態への副作用なし）

**Non-Goals:**
- ダッシュボードからのメッセージ操作（送信・返信）
- 履歴分析やログ集約
- WASM プラグイン統合（スタンドアロンバイナリ方式を採用）

## Decisions

### 1. TUI 描画に ratatui + crossterm を採用
**選択**: ratatui 0.29 + crossterm 0.28
**理由**: ratatui は Rust のデファクト TUI ライブラリ。crossterm はクロスプラットフォームのターミナル制御を提供。両方とも軽量でメンテナンスが活発。
**検討した代替案**: crossterm 単体 — テーブル+サマリーのレイアウトには手動作業が多すぎる。

### 2. ポーリング間隔 2 秒
**選択**: `crossterm::event::poll(Duration)` による固定 2 秒ポーリング
**理由**: ファイル I/O コストと応答性のバランス。リレーストアは JSON ファイルなのでポーリングは軽量。poll タイムアウトがキーボード入力チェック間隔も兼ねる。
**検討した代替案**: ファイルウォッチャー（notify crate）— ステータスファイルの更新頻度が低いため、複雑さに見合わない。

### 3. 新メソッドによる読み取り専用ストアアクセス
**選択**: `check_inbox()` の再利用ではなく、`has_pending()` と `recent_messages(limit)` を `MessageStore` に追加
**理由**: `check_inbox()` はメッセージを既読にしペンディングフラグをクリアする — ダッシュボードの表示専用目的には破壊的。新メソッドは副作用なし。

### 4. Zellij レイアウトの 4 つ目タブ
**選択**: support タブの後に dashboard タブを追加し、`std::env::current_exe()` で `ovld dashboard` を実行
**理由**: 同じバイナリパスを使うことでダッシュボードのバージョンが実行中の ovld と一致する。最後に配置することで既存のペイン ID マッピング (0-5) が通知ルーティングに影響しない。

## Risks / Trade-offs

- **[毎ポーリングでファイル I/O]** → 許容範囲: 6ステータスファイル + ペンディングチェック + 受信箱スキャンで 2 秒ごと約 20 ファイル読み取り。モダンなファイルシステムでは無視できる。
- **[ターミナルでの絵文字レンダリング]** → 一部のターミナルでは絵文字の幅が不一致。カラム幅を 6 文字に設定し大半のケースに対応。
- **[ダッシュボードペインのクラッシュ]** → `ovld dashboard` がパニックしてもダッシュボードタブのみ影響。エージェントペインは独立して動作し続ける。
